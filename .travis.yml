language: cpp

# sudo: false # Use new travis container build -- ppa:kalakris/cmake not whitelisted yet
compiler:
   - gcc
   - clang

env:
   global:
      - secure: "aNwINKV34aR1sG/EMd9VKpBtc4C0sZ1hz2bDVrsh6wAN9rcRAy04dVgeBbRFzeN4Vkzl5pZnp2eOO8JX43+MiMuQCnANo3iW3pGencMC+sgxX0QEl86XMqtfBUQc+dqtNvm2W/tVsGe/TFs8F4AiupfJeGAIAQQMg6jmdgHEw6Q="

addons:
   coverity_scan:
      project:
         name: "EEnginE/engine"
         description: "Build submitted via Travis CI"
      notification_email: mensinda42@gmail.com
      build_command_prepend: "./generate.sh qQltp; mkdir build_cs; cd build_cs; cmake ..; make clean; cd .."
      build_command:   "cd build_cs; make -j 4"
      branch_pattern: master

   apt:
      sources:
         - boost-latest
         - ubuntu-toolchain-r-test
         - llvm-toolchain-precise-3.6

      packages:
         - g++-5
         - gcc-5
         - clang-3.6
         - clang-format-3.6
         - libboost-filesystem1.55-dev

install:
   - sudo add-apt-repository ppa:kalakris/cmake -y
   - sudo apt-get update -qq
   - sudo apt-get install -qq cmake
   - if [[ "$CXX" == "clang++" ]]; then export CXX=clang++-3.6; export CC=clang-3.6; fi
   - if [[ "$CXX" == "g++"     ]]; then export CXX=g++-5;       export CC=gcc-5;     fi

script:
   - ./generate.sh qQltp
   - mkdir build
   - cd build
   - cmake ..
   - make -j2

notifications:
  webhooks:
    urls:
      - https://webhooks.gitter.im/e/a1f79a324c696ec10d8a
    on_success: always  # options: [always|never|change] default: always
    on_failure: always  # options: [always|never|change] default: always
    on_start: false     # default: false
